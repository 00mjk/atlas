\chapter{Initialize and finalize}
In this very brief chapter we show how to 
initialize and finalize the Atlas library 
in both C++ (\sect{s:atlas-section1-C}) 
and Fortran (\sect{s:atlas-section1-F}). 



\section{C++ version}
\label{s:atlas-section1-C}
The C++ version of the \Atlas initialization and finalization 
calls is depicted in \lista{code1-C}.
%
\lstinputlisting[caption=Initialization and finalization of 
\Atlas using C++, style=CStyle, label=code1-C]{section1.cc}
%

In line 1, we include the \Atlas header file, we successively 
specify a simple main function, in which we call the initialization 
of the \Atlas library at line 5.
Note that we passed the two arguments of the main function 
\inltc{argc} and \inltc{argv} to the \inltc{atlas\_initialize} 
function.

We finally call the \Atlas \inltc{atlas\_finalize()} function 
at line 6 without passing any argument to it.

The function \inltc{atlas\_initialize()} is responsible for 
the login and for the initialization of MPI (Message Passage 
Interface), while the function \inltc{atlas\_finalize()} is 
responsible for finalizing MPI and closing the program.

The code in \lista{code1-C}, once compiled, generates an executable 
called \inlsh{atlas\_c-section1} which can be found in:
%
\begin{lstlisting}[style=BashStyle]
atlas/docs/user-guide/section1/
\end{lstlisting}
% 

\begin{notebox}
If you have compiled the documentation, you automatically have 
the executable file just mentioned without the need of doing 
any additional step.
\end{notebox}
%
If we simply run the executable file as follows:
%
\begin{lstlisting}[style=BashStyle]
./atlas_c-section1
\end{lstlisting}
% 
we obtain no output. 
However, by typing some command line instructions we can retrieve 
some useful information. In particular, if we type:
%
\begin{lstlisting}[style=BashStyle]
./atlas_c-section1 --debug
\end{lstlisting}
%
we should obtain something similar to the following output:
%
\begin{lstlisting}[style=BashStyle]
./atlas_f-section1 --debug
[0] (2015-12-21 T 16:02:00) (D) -- Atlas program [atlas_c-section1]
[0] (2015-12-21 T 16:02:00) (D) --   atlas version [0.5.0]
[0] (2015-12-21 T 16:02:00) (D) --   atlas git     [0ab056c960c6744 \
526ccb6605e6b342e79a5c65e]
[0] (2015-12-21 T 16:02:00) (D) --   eckit version [0.10.0]
[0] (2015-12-21 T 16:02:00) (D) --   eckit git     [5ab82c9b22d6fc1 \
33f3cbda1cbc7137c1bd6827b]
[0] (2015-12-21 T 16:02:00) (D) --   Configuration read from scripts:
[0] (2015-12-21 T 16:02:00) (D) --   rundir  : \ 
/var/tmp/nagm/builds/dev/gnu_debug/atlas/docs/user-guide/section1
[0] (2015-12-21 T 16:02:00) (D) -- Atlas finalized
\end{lstlisting}
%
which gives us some information such as the version of \Atlas we are 
running, the identifier of the commit and the path of the executable. 



\section{Fortran version}
\label{s:atlas-section1-F}
The Fortran version of the \Atlas initialization and finalization 
calls is depicted in \lista{code1-F}.
%
\lstinputlisting[caption=Initialization and finalization of 
\Atlas using Fortran, style=FStyle, label=code1-F]{section1.F90}
%

On line 1, we define the program, called \inltf{section1}.
On line 3, we include the required \Atlas libraries
(note that we include only the two functions required 
for this example - i.e. \inltf{atlas\_init} and \inltf{atlas\_finalize}).
We finally call the two functions \inltf{atlas\_init()} 
on lines 5 and 6 and we close the program on line 8.

The function \inltf{atlas\_init()} is responsible for the login 
and for the initialization of MPI (Message Passage Interface), 
while the function \inltf{atlas\_finalize()} is responsible for
finalizing MPI and closing the program.

The code in Listing 1, once compiled, generates an executable 
called \inlsh{atlas\_f-section1} which can be found in:
%
\begin{lstlisting}[style=BashStyle]
atlas/docs/user-guide/section1/
\end{lstlisting}

% 
\begin{notebox}
If you have compiled the documentation, you automatically have 
the executable file just mentioned without the need of doing 
any additional step.
\end{notebox}
%

If we simply run the executable file as follows:
%
\begin{lstlisting}[style=BashStyle]
./atlas_f-section1
\end{lstlisting}
% 
we obtain no output. 
However, by typing some command line instructions we can 
retrieve some useful information. In particular, if we 
type:
%
\begin{lstlisting}[style=BashStyle]
./atlas_f-section1 --debug
\end{lstlisting}
%
we should obtain something similar to the following output:
%
\begin{lstlisting}[style=BashStyle]
./atlas_f-section1 --debug
[0] (2015-12-21 T 16:02:00) (D) -- Atlas program [atlas_f-section1]
[0] (2015-12-21 T 16:02:00) (D) --   atlas version [0.5.0]
[0] (2015-12-21 T 16:02:00) (D) --   atlas git     [0ab056c960c6744 \
526ccb6605e6b342e79a5c65e]
[0] (2015-12-21 T 16:02:00) (D) --   eckit version [0.10.0]
[0] (2015-12-21 T 16:02:00) (D) --   eckit git     [5ab82c9b22d6fc1 \
33f3cbda1cbc7137c1bd6827b]
[0] (2015-12-21 T 16:02:00) (D) --   Configuration read from scripts:
[0] (2015-12-21 T 16:02:00) (D) --   rundir  : \ 
/var/tmp/nagm/builds/dev/gnu_debug/atlas/docs/user-guide/section1
[0] (2015-12-21 T 16:02:00) (D) -- Atlas finalized
\end{lstlisting}
%

\begin{tipbox}
The outputs obtained for the Fortran and C++ version should be identical
since they call exactly the same routines. 
\end{tipbox}



\section{Summary}
From these very brief examples you should now be familiar 
with the following concepts: 
\begin{itemize}
\item how to initialize \Atlas in both C++ and Fortran,
\item how to finalize \Atlas,
\item the function of the \Atlas initialization and finalization.
\end{itemize}
